create or replace PROCEDURE USP_GET_GLMS_ADV_REPORTS
(
I_EMPLOYEE_ID VARCHAR2,
I_EMPLOYEE_ROLE VARCHAR2,
I_FROM_DATE VARCHAR2,
I_TO_DATE  VARCHAR2,
I_RM_ID VARCHAR2,
I_PRODUCT VARCHAR2,
I_CHANNEL VARCHAR2,
I_DOC_DOR VARCHAR2,
I_RESULT VARCHAR2,
I_LAST_MEETING_DATE VARCHAR2,
I_QUOTE_ISSUE_DATE VARCHAR2,
I_FILTER VARCHAR2,
I_STATUS VARCHAR2,
IO_CURSOR OUT SYS_REFCURSOR
)
/*Created By Chithra Ravi Feb-2015*/
AS
VAR_RM_ID VARCHAR2(2000);
VAR_RIDERS VARCHAR2(2000);
VAR_RIDER_COUNT INTEGER:=0;
VAR_OPTIONS VARCHAR2(500);
VAR_OPTION_COUNT INTEGER:=0;
VAR_CURR_FUND_COUNT INTEGER:=0;
VAR_CURR_FUND_AMT VARCHAR2(3000);
VAR_CSPOC_COUNT INTEGER:=0;
VAR_BSPOC_COUNT INTEGER:=0;
VAR_BSPOC VARCHAR2(2000);
VAR_CSPOC VARCHAR2(2000);
VAR_ESPOC_COUNT INTEGER:=0;
VAR_ESPOC VARCHAR2(2000);
VAR_ACQRD_PROV_COUNT INTEGER:=0;
VAR_ACQRD_PROV VARCHAR2(2000);
VAR_INTRO_RIDER_COUNT INTEGER:=0;
VAR_INTRO_OPTIONS_COUNT INTEGER:=0;
VAR_QUOTE_RIDER_COUNT INTEGER:=0;
VAR_QUOTE_OPTIONS_COUNT INTEGER:=0;
VAR_INTRO_RIDERS VARCHAR2(2000);
VAR_INTRO_OPTIONS VARCHAR2(2000);
VAR_QUOTE_RIDERS VARCHAR2(2000);
VAR_QUOTE_OPTIONS VARCHAR2(2000);
INT_UP_FOLL_UP_COUNT INTEGER :=0;
INT_SEQ_QUOTE INTEGER:=0;
INT_SEQ_FOLL INTEGER:=0;
INT_COUNTER INTEGER :=0;

CURSOR CUR_PRODUCT_CLIENT IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE,PROD_INFO_PRODUCT_ID
        FROM GLMS_PRODUCT_INFO_DETAILS CP
              LEFT JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active') 
        WHERE TO_DATE(TRUNC(PROD_INFO_CREATED_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
              --AND (I_LAST_MEETING_DATE IS NULL 
               --     OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                 --  )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_PRODUCT_CLIENT CUR_PRODUCT_CLIENT%ROWTYPE; 

CURSOR CUR_CLIENT_CREATION IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE,PROD_INFO_PRODUCT_ID
        FROM GLMS_CLIENT_DETAILS CDT
              JOIN GLMS_PRODUCT_INFO_DETAILS CP  ON(CP.PROD_INFO_CLIENT_CODE = CDT.CLI_CLIENT_CODE)
              JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active') 
        WHERE TO_DATE(TRUNC(CLI_CREATED_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
             -- AND (I_LAST_MEETING_DATE IS NULL 
              --      OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
              --      OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
              --      OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
              --      OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
              --     )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_CLIENT_CREATION CUR_CLIENT_CREATION%ROWTYPE; 

CURSOR CUR_NEXT_YEAR_CREATION IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE_HIS,PROD_INFO_PRODUCT_ID_HIS
        FROM GLMS_CLIENT_DETAILS CDT
              JOIN GLMS_PRODUCT_INFO_DETAILS_HIS CP  ON(CP.PROD_INFO_CLIENT_CODE_HIS = CDT.CLI_CLIENT_CODE)
              JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE_HIS = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID_HIS = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='History')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE_HIS = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID_HIS = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='History')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE_HIS = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID_HIS = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='History') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE_HIS = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID_HIS = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='History')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE_HIS = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID_HIS = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='History') 
        WHERE TO_DATE(TRUNC(PROD_INFO_MODIFIED_DATE_HIS),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID_HIS) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS_HIS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
             -- AND (I_LAST_MEETING_DATE IS NULL 
              --      OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --    )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='History')
              AND CP.PROD_INFO_RM_ID_HIS IN (SELECT COLUMN_VALUE 
                                     FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_NEXT_YEAR_CREATION CUR_NEXT_YEAR_CREATION%ROWTYPE; 

CURSOR CUR_RESULT_DATE IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE,PROD_INFO_PRODUCT_ID
        FROM GLMS_PRODUCT_INFO_DETAILS CP
              LEFT JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active') 
        WHERE TO_DATE(TRUNC(RESLT_CREATED_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              --AND (I_STATUS IS NULL OR UPPER(RESLT_STATUS)=UPPER(I_STATUS))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
              --AND (I_LAST_MEETING_DATE IS NULL 
              --      OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --     OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
               --    )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_RESULT_DATE CUR_RESULT_DATE%ROWTYPE;

CURSOR CUR_QUOT_SUBEST_DATE IS   
       SELECT DISTINCT QUOT_CLIENT_CODE as PROD_INFO_CLIENT_CODE,QUOT_PROD_ID as PROD_INFO_PRODUCT_ID
        FROM GLMS_QUOTE_SUBMISSION GQ
              LEFT JOIN GLMS_CLIENT_INTRODUCTION CI  ON(GQ.QUOT_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND GQ.QUOT_PROD_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(GQ.QUOT_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND GQ.QUOT_PROD_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(GQ.QUOT_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND GQ.QUOT_PROD_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_PRODUCT_INFO_DETAILS CP ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active')  
        WHERE TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              --AND (I_STATUS IS NULL OR UPPER(QUOT_STATUS)=UPPER(I_STATUS))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
              --AND (I_LAST_MEETING_DATE IS NULL 
                --    OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --   )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_QUOT_SUBEST_DATE CUR_QUOT_SUBEST_DATE%ROWTYPE;

CURSOR CUR_DOC_DOR_DATE IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE,PROD_INFO_PRODUCT_ID
        FROM GLMS_PRODUCT_INFO_DETAILS CP
              LEFT JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active') 
        WHERE TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')
              AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_RESULT IS NULL OR UPPER(GR.RESLT_RESULT) = UPPER(I_RESULT))
              --AND (I_STATUS IS NULL OR UPPER(RESLT_STATUS)=UPPER(I_STATUS))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
              --AND (I_LAST_MEETING_DATE IS NULL 
                --    OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --   )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_DOC_DOR_DATE CUR_DOC_DOR_DATE%ROWTYPE;

CURSOR CUR_LAST_MEETING_DATE IS   
       SELECT DISTINCT PROD_INFO_CLIENT_CODE,PROD_INFO_PRODUCT_ID
        FROM GLMS_PRODUCT_INFO_DETAILS CP
              LEFT JOIN GLMS_CLIENT_INTRODUCTION CI  ON(CP.PROD_INFO_CLIENT_CODE = CI.CLI_INTRO_CLIENT_CODE
                         AND CP.PROD_INFO_PRODUCT_ID = CI.CLI_INTRO_PROD_ID
                         AND CI.CLI_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_INTRODUCTION_ETL_SPOC ETL ON(CP.PROD_INFO_CLIENT_CODE = ETL.ETL_SPOC_INTRO_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = ETL.ETL_SPOC_INTRO_PROD_ID
                          AND ETL.ETL_SPOC_INTRO_STATUS ='Active')
              LEFT JOIN GLMS_RESULT GR ON(CP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                          AND GR.RESLT_STATUS ='Active') 
              LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON(CP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                          AND GQ.QUOT_STATUS ='Active')
              LEFT JOIN GLMS_FOLLOW_UP GF ON(CP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                          AND CP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                          AND GF.FOLL_UP_STATUS ='Active') 
        WHERE (TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY') AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY') AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY')  AND TO_DATE(I_TO_DATE,'DD-Mon-YY')
              OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') BETWEEN TO_DATE(I_FROM_DATE,'DD-Mon-YY') AND TO_DATE(I_TO_DATE,'DD-Mon-YY'))
              AND (I_RM_ID IS NULL OR UPPER(CI.CLI_INTRO_RM_ID) = UPPER(I_RM_ID))
              AND (I_PRODUCT IS NULL OR UPPER(CP.PROD_INFO_PRODUCT_ID) = UPPER(I_PRODUCT))
              AND (I_CHANNEL IS NULL OR UPPER(ETL.ETL_SPOC_INTRO_SPOC_GROUP) = UPPER(I_CHANNEL))
              AND (I_STATUS IS NULL OR UPPER(PROD_INFO_PRODUCT_STATUS)=UPPER(I_STATUS))
              --AND (I_DOC_DOR IS NULL OR TO_DATE(TRUNC(GR.RESLT_DOC_DOR_DATE),'DD-Mon-YY') = TO_DATE(I_DOC_DOR,'DD-Mon-YY'))
              --AND (I_QUOTE_ISSUE_DATE IS NULL OR TO_DATE(TRUNC(GQ.QUOT_SUBEST_LIAB_FUND_DATE),'DD-Mon-YY') = TO_DATE(I_QUOTE_ISSUE_DATE,'DD-Mon-YY'))
              --AND (I_LAST_MEETING_DATE IS NULL 
                --    OR TO_DATE(TRUNC(CI.CLI_INTRO_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GF.FOLL_UP_NXT_FOLLUP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GQ.QUOT_FOLL_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --    OR TO_DATE(TRUNC(GR.RESLT_FOLLOW_UP_DATE),'DD-Mon-YY') = TO_DATE(I_LAST_MEETING_DATE,'DD-Mon-YY')
                --   )
              AND (CLI_INTRO_ID IS NULL OR CI.CLI_INTRO_STATUS ='Active')
              AND CP.PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                      FROM TABLE (FN_STR2TBL(VAR_RM_ID,',')));
RW_LAST_MEETING_DATE CUR_LAST_MEETING_DATE%ROWTYPE;

BEGIN
    EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT = ''DD-Mon-YYYY''';
    IF UPPER(I_EMPLOYEE_ROLE) = 'ADMIN' THEN
      BEGIN
          SELECT  RTRIM(XMLAGG(XMLELEMENT(E,PROD_INFO_RM_ID || ',')).EXTRACT ('//text()'),',')  INTO VAR_RM_ID 
            FROM  (SELECT DISTINCT  PROD_INFO_RM_ID   
                     FROM GLMS_PRODUCT_INFO_DETAILS 
                  ) RM_DATA;
      END;
      ELSIF UPPER(I_EMPLOYEE_ROLE) = 'GENERAL' THEN
        BEGIN
             SELECT RTRIM(XMLAGG(XMLELEMENT(E,PROD_INFO_RM_ID || ',')).EXTRACT ('//text()'),',') INTO VAR_RM_ID
             FROM(
                SELECT DISTINCT PROD_INFO_RM_ID
                  FROM GLMS_PRODUCT_INFO_DETAILS 
                 ) RM_DATA
                 WHERE PROD_INFO_RM_ID IN (SELECT COLUMN_VALUE 
                                           FROM TABLE (FN_STR2TBL(FN_GET_GLMS_EMPLOYEES(I_EMPLOYEE_ID),',')));
        END;
      END IF;
     DELETE FROM GLMS_REPORTS_DETAILS;
     COMMIT;
     
     IF(I_FILTER='Client creation date')THEN
     
     FOR RW_PRODUCT_CLIENT IN CUR_CLIENT_CREATION
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
               
       END LOOP;
       
       ELSIF(I_FILTER='Past years information')THEN
       
       FOR RW_PRODUCT_CLIENT IN CUR_NEXT_YEAR_CREATION
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                    AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                    AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                        AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                      AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                       AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                        AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                   AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                   AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                     AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                      AND ETL_SPOC_INTRO_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                           AND ETL_SPOC_INTRO_PROD_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                      AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS= 'GRA_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS= 'GRA_ULIP' 
                      OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS= 'LE_ULIP' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS= 'LE_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS AND QUOT_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS AND FOLL_UP_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE_HIS AND PROD_INFO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID_HIS;
                                    COMMIT;
               
       END LOOP;
       
       ELSIF(I_FILTER='Result date')THEN
       
       FOR RW_PRODUCT_CLIENT IN CUR_RESULT_DATE
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
               
       END LOOP;
       
     ELSIF(I_FILTER='DOC/DOR')THEN
       
       FOR RW_DOC_DOR_DATE IN CUR_DOC_DOR_DATE 
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_DOC_DOR_DATE.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_DOC_DOR_DATE.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
               
       END LOOP;
     
     ELSIF(I_FILTER='Quote Issue Date')THEN
       
       FOR RW_QUOT_SUBEST_DATE IN CUR_QUOT_SUBEST_DATE 
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                       INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             --LEFT JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             --LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                               --                                       AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                 --                                     AND GQ.QUOT_STATUS='Active'
                                                   --                                   AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE QUOT_CLIENT_CODE = RW_QUOT_SUBEST_DATE.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_QUOT_SUBEST_DATE.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
               
       END LOOP;
     ELSIF(I_FILTER='Last Meeting Date')THEN
       
       FOR RW_LAST_MEETING_DATE IN CUR_LAST_MEETING_DATE
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_LAST_MEETING_DATE.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_LAST_MEETING_DATE.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
               
       END LOOP;
       
     
   ELSIF(I_FILTER='Product Created Date')THEN
     
     FOR RW_PRODUCT_CLIENT IN CUR_PRODUCT_CLIENT
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
    END LOOP;
    
    ELSE
        
     FOR RW_PRODUCT_CLIENT IN CUR_PRODUCT_CLIENT
       LOOP
           VAR_RIDERS:='';
           VAR_OPTIONS:='';
           VAR_CURR_FUND_AMT:='';
           VAR_BSPOC:='';
           VAR_CSPOC:='';
           VAR_ACQRD_PROV:='';
           VAR_INTRO_RIDERS:='';
           VAR_INTRO_OPTIONS:='';
           VAR_QUOTE_RIDERS:='';
           VAR_QUOTE_OPTIONS:='';
           INT_SEQ_QUOTE:=0;
           INT_SEQ_FOLL:=0;
           VAR_ESPOC:='';
           SELECT COUNT(1) INTO VAR_RIDER_COUNT FROM GLMS_PRODUCT_RIDER 
              WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             IF(VAR_RIDER_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_PROD_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_RIDERS
                   FROM GLMS_PRODUCT_RIDER PR
                  WHERE RID_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND RID_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
             END IF;

              SELECT COUNT(1) INTO VAR_OPTION_COUNT FROM GLMS_PRODUCT_OPTION 
              WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                    AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_OPTION_COUNT<>0) THEN
                 SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_OPTIONS
                 FROM GLMS_PRODUCT_OPTION 
                WHERE OPTN_PROD_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND OPTN_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
              SELECT COUNT(1) INTO VAR_CURR_FUND_COUNT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              IF(VAR_CURR_FUND_COUNT <> 0)THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,PORTF_PROD_INSUR_FUND_BUSS||'|'|| TO_CHAR(PORTF_PROD_PORTFOLIO_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_CURR_FUND_AMT
                FROM GLMS_PRODUCT_PORTFOLIO WHERE PORTF_PROD_CLIENT_ID = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND PORTF_PROD_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
              END IF;
              
               SELECT COUNT(1) INTO VAR_INTRO_RIDER_COUNT
                FROM GLMS_INTRO_RIDER 
               WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_INTRO_STATUS = 'Active';
              IF(VAR_INTRO_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_INTRO_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_RIDERS
                   FROM GLMS_INTRO_RIDER 
                  WHERE RID_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND RID_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND RID_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_INTRO_OPTIONS_COUNT
                FROM GLMS_INTRO_OPTION
               WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
              IF(VAR_INTRO_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_INTRO_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_INTRO_OPTIONS
                   FROM GLMS_INTRO_OPTION 
                    WHERE OPTN_INTRO_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND OPTN_INTRO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND OPTN_STATUS = 'Active';
               END IF;
              SELECT COUNT(1) INTO VAR_QUOTE_RIDER_COUNT
                FROM GLMS_QUOTE_RIDER 
               WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                     AND RID_QUOTE_STATUS = 'Active';
              IF(VAR_QUOTE_RIDER_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,RID_QUOTE_RIDER_ID||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_RIDERS
                 FROM GLMS_QUOTE_RIDER 
                WHERE RID_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND RID_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                      AND RID_QUOTE_STATUS = 'Active';
               END IF;
               
                SELECT COUNT(1) INTO VAR_QUOTE_OPTIONS_COUNT
                  FROM GLMS_QUOTE_OPTION
                 WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                       AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                       AND OPTN_STATUS = 'Active';
              IF(VAR_QUOTE_OPTIONS_COUNT <>0) THEN
               SELECT RTRIM(XMLAGG(XMLELEMENT(R,OPTN_QUOTE_DESC||',')).EXTRACT('//text()'),',')  INTO VAR_QUOTE_OPTIONS
                   FROM GLMS_QUOTE_OPTION 
                  WHERE OPTN_QUOTE_CLIENT_CODE =  RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                        AND OPTN_QUOTE_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID
                        AND OPTN_STATUS = 'Active';
               END IF; 
             
            SELECT COUNT(1) INTO VAR_BSPOC_COUNT
              FROM GLMS_BROKER_DETAILS CD 
                   INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
             WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active'; 
            IF(VAR_BSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,BROK_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_BSPOC
                FROM GLMS_BROKER_DETAILS CD 
                     INNER JOIN GLMS_CLIENT_BROKER_DETAILS CCD ON(CCD.BROK_SPOC_DETAILS_ID = CD.BROK_SPOC_ID)
               WHERE BROK_SPOC_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND BROK_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND BROK_SPOC_STATUS = 'Active';
            END IF;
            
            SELECT COUNT(1) INTO VAR_CSPOC_COUNT
              FROM GLMS_CLIENT_SPOC CD 
                   INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
             WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                   AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
             IF(VAR_CSPOC_COUNT <>0) THEN
              SELECT RTRIM(XMLAGG(XMLELEMENT(E,CLI_SPOC_DETAILS_NAME || ',')).EXTRACT('//text()'),',') INTO VAR_CSPOC
                FROM GLMS_CLIENT_SPOC CD 
                     INNER JOIN GLMS_CLIENT_SPOC_DETAILS CCD ON(CCD.CLI_SPOC_DETAILS_ID = CD.CLI_SPOC_ID)
               WHERE CLI_SPOC_CLI_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                     AND CLI_SPOC_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND CLI_SPOC_STATUS = 'Active';
              END IF;
              
              SELECT  COUNT(1) INTO VAR_ESPOC_COUNT
                FROM  GLMS_INTRODUCTION_ETL_SPOC ES
                      INNER JOIN GLMS_MASTER_TABLE MT ON(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID AND UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                      INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                WHERE ETL_SPOC_INTRO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ETL_SPOC_INTRO_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               IF(VAR_ESPOC_COUNT<>0)THEN
                    SELECT RTRIM(XMLAGG(XMLELEMENT(E,MT.MASTER_DESC||'|'||MT1.MASTER_DESC || ',')).EXTRACT('//text()'),',') INTO VAR_ESPOC
                      FROM GLMS_INTRODUCTION_ETL_SPOC ES
                           INNER JOIN GLMS_MASTER_TABLE MT on(ES.ETL_SPOC_INTRO_SPOC_NAME = MT.MASTER_VALU_ID and UPPER(MT.MASTER_TYP_ID) = 'ETLSPOC')
                           INNER JOIN GLMS_MASTER_TABLE MT1 ON(ES.ETL_SPOC_INTRO_SPOC_GROUP = MT1.MASTER_VALU_ID AND UPPER(MT1.MASTER_TYP_ID) = 'ETLCHANNEL')
                     WHERE ETL_SPOC_INTRO_CLIENT_CODE =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                           AND ETL_SPOC_INTRO_PROD_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ETL_SPOC_INTRO_STATUS = 'Active';
               END IF;
               
               SELECT COUNT(1) INTO VAR_ACQRD_PROV_COUNT
                 FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                      AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
               IF(VAR_ACQRD_PROV_COUNT <> 0) THEN
                  IF(RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'GRA_ULIP' 
                      OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_ULIP' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'LE_TRAD' OR RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID= 'SUP_ANN') THEN
                        SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER||'|'|| TO_CHAR(ACORD_PROD_FUND_AMT,'fm999999999999999.90') || ',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  ELSE
                       SELECT RTRIM(XMLAGG(XMLELEMENT(E,ACORD_PROD_PROVIDER ||',')).EXTRACT('//text()'),',') INTO VAR_ACQRD_PROV
                          FROM GLMS_ACQRD_PROVIDER_FUND_AMT 
                         WHERE ACORD_PROD_CLIENT_ID =RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE
                               AND ACORD_PROD_PRODUCT_ID =RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND ACORD_PROD_STATUS = 'Active';
                  END IF;
               END IF; 
               SELECT  MAX(QUOT_SEQ_NO) INTO INT_SEQ_QUOTE FROM GLMS_QUOTE_SUBMISSION  
               WHERE QUOT_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND QUOT_PROD_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND QUOT_STATUS = 'Active';
               SELECT  MAX(FOLL_UP_SEQ_NO) INTO INT_SEQ_FOLL FROM GLMS_FOLLOW_UP 
               WHERE FOLL_UP_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND FOLL_UP_PROD_ID =  RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID AND FOLL_UP_STATUS = 'Active';
               
            INSERT INTO GLMS_REPORTS_DETAILS( CLI_CLIENT_CODE,
                                              CLI_CLIENT_NAME,
                                              CLI_GRP_COMPANY_NAME,
                                              CLI_ADDRESS,
                                              CLI_CITY,
                                              CLI_STATE,
                                              CLI_PINCODE,
                                              CLI_ESTB_YEAR,
                                              CLI_INDUSTRY_TYPE,
                                              CLI_DESC_OTHERS,
                                              CLI_GROUP_SIZE,
                                              CLI_COMPANY_WEBSITE,
                                              PROD_INFO_PRODUCT_ID,
                                              PROD_INFO_CLIENT_CODE,
                                              PROD_INFO_PRODUCT_STATUS,
                                              PROD_INFO_CASE_TYPE,
                                              PROD_INFO_COMCMT_REN_DATE,
                                              PROD_INFO_BENEFIT_STRUCT,
                                              PROD_INFO_DESC_OTHER,
                                              PROD_INFO_EXIST_PREM_EXCL_TAX,
                                              PROD_INFO_EXIST_INSR_LI,
                                              PROD_INFO_EXIST_TRUST_IND,
                                              PROD_INFO_MANAGE_TYPE,
                                              PROD_INFO_TOTAL_FUND_VAL,
                                              PROD_INFO_IS_RIDER,
                                              PROD_INFO_IS_OPTIONS,
                                              PROD_INFO_RIDERS,
                                              PROD_INFO_OPTIONS,
                                              PROD_INFO_CURR_FUND_VALUE,
                                              CLI_INTRO_ID,
                                              CLI_INTRO_STATUS,
                                              CLI_INTRO_INTERACTION_TYPE,
                                              CLI_INTRO_PROD_ID,
                                              CLI_INTRO_CLIENT_CODE,
                                              CLI_INTRO_RM_ID,
                                              CLI_INTRO_RM_NAME,
                                              CLI_INTRO_BUSSINESS_SOURCE,
                                              CLI_INTRO_RELATIONSHIP,
                                              CLI_INTRO_MEETING_DATE,
                                              CLI_INTRO_MEETING_COMM,
                                              CLI_INTRO_FOLLOW_UP_DATE,
                                              CLI_INTRO_CSPOC,
                                              CLI_INTRO_BSPOC,
                                              CLI_INTRO_ESPOC,
                                              CLI_INTRO_RIDERS, 
                                              CLI_INTRO_OPTIONS,
                                              FOLL_UP_ID,
                                              FOLL_UP_SEQ_NO,
                                              FOLL_UP_MEETING_DATE,
                                              FOLL_UP_MEETING_COMMTS,
                                              FOLL_UP_NXT_FOLLUP_DATE,
                                              QUOT_ID,
                                              QUOT_SEQ_NO,
                                              QUOT_INTERACTION_TYPE,
                                              QUOT_NO_OF_INSRD_MEM,
                                              QUOT_ETLIFE_PREM_RATE,
                                              QUOT_ETLIFE_PREM_AMT,
                                              QUOT_NO_OF_INSRD_EMP,
                                              QUOT_FUND_CONTRI_AMT,
                                              QUOT_FUND_POTEN_ETLIFE_AMT,
                                              QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                              QUOT_SUBEST_LIAB_FUND_DATE,
                                              QUOT_LEAD_CATG,
                                              QUOT_MEETING_COMMTS,
                                              QUOT_TENT_CLOSURE_DATE,
                                              QUOT_FOLL_UP_DATE,
                                              QUOT_RIDERS, 
                                              QUOT_OPTIONS,
                                              RESLT_ID,
                                              RESLT_INTERACTION_TYPE,
                                              RESLT_POLICY_NO,
                                              RESLT_CONF_DATE,
                                              RESLT_RESULT,
                                              RESLT_REASON,
                                              RESLT_DESC_OTHER,
                                              RESLT_RENEWED_WITH,
                                              RESLT_CLOSURE_RATE,
                                              RESLT_CLOSURE_PREM_AMT,
                                              RESLT_CLOSURE_FCL,
                                              RESLT_RIDER_INFO,
                                              RESLT_UW_LIMITS,
                                              RESLT_PROFIT_SHARING_IND,
                                              RESLT_DOC_DOR_DATE,
                                              RESLT_FOLLOW_INS,
                                              RESLT_FOLLOW_UP_DATE,
                                              RESLT_COMMENTS,
                                              RESLT_ACQR_PRVDDR_FUND_AMT,
                                              CLI_INTRO_MODIFIED_DATE,
                                              CLI_INTRO_MODIFIED_BY,
                                              REP_STATUS)
                                    SELECT  CLI_CLIENT_CODE,
                                            CLI_CLIENT_NAME,
                                            CLI_GRP_COMPANY_NAME,
                                            CLI_ADDRESS,
                                            CLI_CITY,
                                            CLI_STATE,
                                            CLI_PINCODE,
                                            CLI_ESTB_YEAR,
                                            CLI_INDUSTRY_TYPE,
                                            CLI_DESC_OTHERS,
                                            CLI_GROUP_SIZE,
                                            CLI_COMPANY_WEBSITE,
                                            PROD_INFO_PRODUCT_ID,
                                            PROD_INFO_CLIENT_CODE,
                                            PROD_INFO_PRODUCT_STATUS,
                                            PROD_INFO_CASE_TYPE,
                                            PROD_INFO_COMCMT_REN_DATE,
                                            PROD_INFO_BENEFIT_STRUCT,
                                            PROD_INFO_DESC_OTHER,
                                            PROD_INFO_EXIST_PREM_EXCL_TAX,
                                            PROD_INFO_EXIST_INSR_LI,
                                            PROD_INFO_EXIST_TRUST_IND,
                                            PROD_INFO_MANAGE_TYPE,
                                            PROD_INFO_TOTAL_FUND_VAL, 
                                            CASE WHEN VAR_RIDER_COUNT = 0
                                            THEN 'N' ELSE 'Y' END,
                                            CASE WHEN VAR_OPTION_COUNT =0
                                            THEN 'N' ELSE 'Y' END,
                                            VAR_RIDERS,
                                            VAR_OPTIONS,
                                            VAR_CURR_FUND_AMT,
                                            CLI_INTRO_ID,
                                            CLI_INTRO_STATUS,
                                            CLI_INTRO_INTERACTION_TYPE,
                                            CLI_INTRO_PROD_ID,
                                            CLI_INTRO_CLIENT_CODE,
                                            CLI_INTRO_RM_ID,
                                            CLI_INTRO_RM_NAME,
                                            CLI_INTRO_BUSSINESS_SOURCE,
                                            CLI_INTRO_RELATIONSHIP,
                                            CLI_INTRO_MEETING_DATE,
                                            CLI_INTRO_MEETING_COMM,
                                            CLI_INTRO_FOLLOW_UP_DATE,
                                            VAR_CSPOC,
                                            VAR_BSPOC,
                                            VAR_ESPOC,
                                            VAR_INTRO_RIDERS,
                                            VAR_INTRO_OPTIONS,
                                            FOLL_UP_ID,
                                            FOLL_UP_SEQ_NO,
                                            FOLL_UP_MEETING_DATE,
                                            FOLL_UP_MEETING_COMMTS,
                                            FOLL_UP_NXT_FOLLUP_DATE,
                                            QUOT_ID,
                                            QUOT_SEQ_NO,
                                            QUOT_INTERACTION_TYPE,
                                            QUOT_NO_OF_INSRD_MEM,
                                            QUOT_ETLIFE_PREM_RATE,
                                            QUOT_ETLIFE_PREM_AMT,
                                            QUOT_NO_OF_INSRD_EMP,
                                            QUOT_FUND_CONTRI_AMT,
                                            QUOT_FUND_POTEN_ETLIFE_AMT,
                                            QUOT_SUBMIT_EST_LIAB_FUND_IND,
                                            QUOT_SUBEST_LIAB_FUND_DATE,
                                            QUOT_LEAD_CATG,
                                            QUOT_MEETING_COMMTS,
                                            QUOT_TENT_CLOSURE_DATE,
                                            QUOT_FOLL_UP_DATE,
                                            VAR_QUOTE_RIDERS,
                                            VAR_QUOTE_OPTIONS,
                                            RESLT_ID,
                                            RESLT_INTERACTION_TYPE,
                                            RESLT_POLICY_NO,
                                            RESLT_CONF_DATE,
                                            RESLT_RESULT,
                                            RESLT_REASON,
                                            RESLT_DESC_OTHER,
                                            RESLT_RENEWED_WITH,
                                            RESLT_CLOSURE_RATE,
                                            RESLT_CLOSURE_PREM_AMT,
                                            RESLT_CLOSURE_FCL,
                                            RESLT_RIDER_INFO,
                                            RESLT_UW_LIMITS,
                                            RESLT_PROFIT_SHARING_IND,
                                            RESLT_DOC_DOR_DATE,
                                            RESLT_FOLLOW_INS,
                                            RESLT_FOLLOW_UP_DATE,
                                            RESLT_COMMENTS,
                                            VAR_ACQRD_PROV,
                                            CLI_INTRO_MODIFIED_DATE,
                                            CLI_INTRO_MODIFIED_BY,
                                            PROD_INFO_PRODUCT_STATUS
                                            --'Active'
                                       FROM GLMS_CLIENT_DETAILS GD
                                             INNER JOIN GLMS_PRODUCT_INFO_DETAILS GP ON (GD.CLI_CLIENT_CODE = GP.PROD_INFO_CLIENT_CODE)
                                             LEFT JOIN GLMS_CLIENT_INTRODUCTION GI ON (GP.PROD_INFO_CLIENT_CODE = GI.CLI_INTRO_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GI.CLI_INTRO_PROD_ID
                                                                                      AND GI.CLI_INTRO_STATUS='Active')
                                             LEFT JOIN GLMS_FOLLOW_UP GF ON (GP.PROD_INFO_CLIENT_CODE = GF.FOLL_UP_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GF.FOLL_UP_PROD_ID
                                                                                      AND GF.FOLL_UP_STATUS='Active'
                                                                                      AND GF.FOLL_UP_SEQ_NO = INT_SEQ_FOLL)
                                             LEFT JOIN GLMS_QUOTE_SUBMISSION GQ ON (GP.PROD_INFO_CLIENT_CODE = GQ.QUOT_CLIENT_CODE
                                                                                      AND GP.PROD_INFO_PRODUCT_ID = GQ.QUOT_PROD_ID
                                                                                      AND GQ.QUOT_STATUS='Active'
                                                                                      AND GQ.QUOT_SEQ_NO = INT_SEQ_QUOTE)
                                             LEFT JOIN GLMS_RESULT GR ON (GP.PROD_INFO_CLIENT_CODE = GR.RESLT_CLIENT_CODE
                                                                          AND GP.PROD_INFO_PRODUCT_ID = GR.RESLT_PROD_ID
                                                                          AND GR.RESLT_STATUS='Active')
                                       WHERE PROD_INFO_CLIENT_CODE = RW_PRODUCT_CLIENT.PROD_INFO_CLIENT_CODE AND PROD_INFO_PRODUCT_ID = RW_PRODUCT_CLIENT.PROD_INFO_PRODUCT_ID;
                                    COMMIT;
                              
       END LOOP;
       
       USP_GET_GLMS_ADV_REPORTS_HIST(I_EMPLOYEE_ID,
                                     I_EMPLOYEE_ROLE,
                                     I_FROM_DATE,
                                     I_TO_DATE,
                                     I_RM_ID,
                                     I_PRODUCT,
                                     I_CHANNEL,
                                     I_DOC_DOR,
                                     I_RESULT,
                                     I_LAST_MEETING_DATE,
                                     I_QUOTE_ISSUE_DATE,
                                     I_STATUS
                                   );
       END IF;
       /*
       USP_GET_GLMS_ADV_REPORTS_HIST(I_EMPLOYEE_ID,
                                     I_EMPLOYEE_ROLE,
                                     I_FROM_DATE,
                                     I_TO_DATE,
                                     I_RM_ID,
                                     I_PRODUCT,
                                     I_CHANNEL,
                                     I_DOC_DOR,
                                     I_RESULT,
                                     I_LAST_MEETING_DATE,
                                     I_QUOTE_ISSUE_DATE
                                   );*/
                                   
      IF(I_FILTER='Quote Issue Date')THEN                             
      OPEN IO_CURSOR FOR 
                     SELECT  CLI_CLIENT_CODE AS "Client Code",
                             CLI_CLIENT_NAME AS "Client Name",
                             CLI_GRP_COMPANY_NAME AS "Name of Group Company",
                             CLI_ADDRESS AS "Company Address",
                             CLI_CITY AS "City",
                             ST.PARAM_VALUE AS "State",
                             CLI_PINCODE AS "Pincode",
                             CLI_ESTB_YEAR AS "Establishment Year",
                             CLI_COMPANY_WEBSITE AS "Company Website",
                             CLI_INDUSTRY_TYPE AS "Industry Type",
                             CLI_GROUP_SIZE AS "Group Size",
                             MT.MASTER_DESC AS "Product Name",
                             PROD_INFO_CASE_TYPE AS "Type of Case",
                             TO_CHAR(PROD_INFO_COMCMT_REN_DATE,'DD-Mon-YYYY') AS "Date of Commencement/Renewal",
                             PROD_INFO_BENEFIT_STRUCT AS "Benefit Structure",
                             PROD_INFO_DESC_OTHER AS "Other Description",
                             PROD_INFO_IS_RIDER AS "Rider",
                             PROD_INFO_RIDERS AS "Name of Riders",
                             PROD_INFO_IS_OPTIONS AS "Options",
                             PROD_INFO_OPTIONS AS "Options Name",
                             PROD_INFO_EXIST_PREM_EXCL_TAX AS "Last Year Premium",
                             PROD_INFO_EXIST_INSR_LI AS "Current Insurer for LI",
                             PROD_INFO_EXIST_TRUST_IND AS "Existing Trust",
                             PROD_INFO_MANAGE_TYPE AS "Management Type",
                             PROD_INFO_TOTAL_FUND_VAL AS "Total Fund Valuation",
                             PROD_INFO_CURR_FUND_VALUE AS "Curr Insurer/Portfolio Amount",
                             REP_STATUS AS "Status",
                             CLI_INTRO_RM_NAME AS "Intro_RM Name",
                             CLI_INTRO_ESPOC AS "Intro_ET Life SPOC/Channel",
                             CLI_INTRO_RELATIONSHIP AS "Intro_Relationship",
                             CLI_INTRO_BUSSINESS_SOURCE AS "Intro_Business Source",
                             CLI_INTRO_CSPOC AS "Intro_Client Side SPOC",
                             CLI_INTRO_BSPOC AS "Intro_Broker Side SPOC",
                             CLI_INTRO_RIDERS AS "Intro_Riders",
                             CLI_INTRO_OPTIONS AS "Intro_Options",
                             TO_CHAR(CLI_INTRO_MEETING_DATE,'DD-Mon-YYYY') AS "Introduction Meeting Date",
                             CLI_INTRO_MEETING_COMM AS "Introduction Meeting Comments",
                             TO_CHAR(CLI_INTRO_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Intro_Next Follow-up Date",
                             TO_CHAR(FOLL_UP_MEETING_DATE,'DD-Mon-YYYY') AS "Follow-up Meeting Date",
                             PROD_INFO_PRODUCT_ID AS "Product For Discussion",
                             FOLL_UP_MEETING_COMMTS AS "Follow-up Meeting Comments",
                             TO_CHAR(FOLL_UP_NXT_FOLLUP_DATE,'DD-Mon-YYYY') AS "Follow-up Next Follow-up Date",
                             GR.QUOT_LEAD_CATG AS "Quote_Lead Category",
                             GR.QUOT_NO_OF_INSRD_EMP  AS "Quote_No. of Insured Employee",
                             GR.QUOT_NO_OF_INSRD_MEM AS "Quote_No. of Insured Members",
                             GR.QUOT_ETLIFE_PREM_RATE AS "Quote_ETlife Premium Rate",
                             GR.QUOT_ETLIFE_PREM_AMT  AS "Quote_Etlife Premium Amount",
                             GR.QUOT_FUND_CONTRI_AMT AS "Quote_Fund Contribution",
                             GR.QUOT_FUND_POTEN_ETLIFE_AMT AS "Quote_Fund Potential",
                             GR.QUOT_SUBMIT_EST_LIAB_FUND_IND AS "Quote Sub/Est Of Fund Lia",
                             QUOT_RIDERS AS "Quote_Riders",
                             QUOT_OPTIONS AS "Quote_Options",
                             TO_CHAR(GR.QUOT_SUBEST_LIAB_FUND_DATE,'DD-Mon-YYYY') AS "Quote_Issue Date/Est of Funds",
                             GR.QUOT_MEETING_COMMTS AS "Quote Meeting Comments",
                             TO_CHAR(GR.QUOT_TENT_CLOSURE_DATE,'DD-Mon-YYYY') AS "Quote_Tentative Closure Date",
                             TO_CHAR(GR.QUOT_FOLL_UP_DATE,'DD-Mon-YYYY')  AS "Quote Follow-up Date",
                             TO_CHAR(RESLT_CONF_DATE,'DD-Mon-YYYY') AS "Result_Confirmation Date",
                             RESLT_RESULT AS "Result_Status",
                             RESLT_REASON AS "Result_Reason",
                             RESLT_DESC_OTHER AS "Result_Other Reason Desc",
                             RESLT_POLICY_NO AS "Policy_No",
                             TO_CHAR(RESLT_DOC_DOR_DATE,'DD-Mon-YYYY') AS "Result_DOC/DOR",
                             RESLT_ACQR_PRVDDR_FUND_AMT AS "Result_Acq Serv Pro/Fund Amt",
                             RESLT_RENEWED_WITH AS "Result_Renewed With",
                             RESLT_CLOSURE_RATE AS "Result_Closure Rate",
                             RESLT_CLOSURE_PREM_AMT AS "Result_Closure Premium",
                             RESLT_CLOSURE_FCL AS "Result_FCL",
                             RESLT_RIDER_INFO AS "Result_Rider Related Info",
                             RESLT_UW_LIMITS AS "Result_UW Limits",
                             RESLT_PROFIT_SHARING_IND AS "Result_Profit Sharing",
                             RESLT_COMMENTS AS "Result Comments",
                             RESLT_FOLLOW_INS AS "Result_Follow-up",
                             TO_CHAR(RESLT_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Result_Follow-up Date",
                             CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_RATE,0) <> 0 
                             THEN  TO_CHAR((((GR.QUOT_ETLIFE_PREM_RATE- NVL(RESLT_CLOSURE_RATE,0))*100)/ GR.QUOT_ETLIFE_PREM_RATE),'fm99999.90') || '%'
                             ELSE '0' END  AS "Rate Difference",
                             NVL(TO_CHAR((GR.QUOT_ETLIFE_PREM_AMT- NVL(RESLT_CLOSURE_PREM_AMT,0)),'fm99999.90'),0) AS "Premium Gap",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_MEM)
                                       ELSE FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_EMP) END AS "Employee Band/Insured Person",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN 
                             FN_GET_GLMS_PRE_AMT_RANGE(CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_AMT,'-1') <> '-1'
                             THEN TO_CHAR(GR.QUOT_ETLIFE_PREM_AMT,'fm99999999999999999.90')
                             ELSE NVL(TO_CHAR(RESLT_CLOSURE_PREM_AMT,'fm99999999999999999.90'),'-1') END)
                             ELSE FN_GET_GLMS_PRE_AMT_RANGE(NVL(TO_CHAR(GR.QUOT_FUND_POTEN_ETLIFE_AMT,'fm99999999999999999.90'),'-1')) END  AS "Premium Amount Bucketing"
                         FROM GLMS_REPORTS_DETAILS GR 
                             LEFT JOIN ING_EDIT ST ON(GR.CLI_STATE = ST.ID)
                             INNER JOIN GLMS_MASTER_TABLE MT ON(GR.PROD_INFO_PRODUCT_ID = MT.MASTER_VALU_ID AND UPPER(MASTER_TYP_ID) = 'PRODUCT')
                             WHERE GR.QUOT_SUBEST_LIAB_FUND_DATE is not null
                             ORDER BY CLI_CLIENT_CODE;
                             
    ELSIF(I_FILTER='DOC/DOR')THEN
     OPEN IO_CURSOR FOR 
                     SELECT  CLI_CLIENT_CODE AS "Client Code",
                             CLI_CLIENT_NAME AS "Client Name",
                             CLI_GRP_COMPANY_NAME AS "Name of Group Company",
                             CLI_ADDRESS AS "Company Address",
                             CLI_CITY AS "City",
                             ST.PARAM_VALUE AS "State",
                             CLI_PINCODE AS "Pincode",
                             CLI_ESTB_YEAR AS "Establishment Year",
                             CLI_COMPANY_WEBSITE AS "Company Website",
                             CLI_INDUSTRY_TYPE AS "Industry Type",
                             CLI_GROUP_SIZE AS "Group Size",
                             MT.MASTER_DESC AS "Product Name",
                             PROD_INFO_CASE_TYPE AS "Type of Case",
                             TO_CHAR(PROD_INFO_COMCMT_REN_DATE,'DD-Mon-YYYY') AS "Date of Commencement/Renewal",
                             PROD_INFO_BENEFIT_STRUCT AS "Benefit Structure",
                             PROD_INFO_DESC_OTHER AS "Other Description",
                             PROD_INFO_IS_RIDER AS "Rider",
                             PROD_INFO_RIDERS AS "Name of Riders",
                             PROD_INFO_IS_OPTIONS AS "Options",
                             PROD_INFO_OPTIONS AS "Options Name",
                             PROD_INFO_EXIST_PREM_EXCL_TAX AS "Last Year Premium",
                             PROD_INFO_EXIST_INSR_LI AS "Current Insurer for LI",
                             PROD_INFO_EXIST_TRUST_IND AS "Existing Trust",
                             PROD_INFO_MANAGE_TYPE AS "Management Type",
                             PROD_INFO_TOTAL_FUND_VAL AS "Total Fund Valuation",
                             PROD_INFO_CURR_FUND_VALUE AS "Curr Insurer/Portfolio Amount",
                             REP_STATUS AS "Status",
                             CLI_INTRO_RM_NAME AS "Intro_RM Name",
                             CLI_INTRO_ESPOC AS "Intro_ET Life SPOC/Channel",
                             CLI_INTRO_RELATIONSHIP AS "Intro_Relationship",
                             CLI_INTRO_BUSSINESS_SOURCE AS "Intro_Business Source",
                             CLI_INTRO_CSPOC AS "Intro_Client Side SPOC",
                             CLI_INTRO_BSPOC AS "Intro_Broker Side SPOC",
                             CLI_INTRO_RIDERS AS "Intro_Riders",
                             CLI_INTRO_OPTIONS AS "Intro_Options",
                             TO_CHAR(CLI_INTRO_MEETING_DATE,'DD-Mon-YYYY') AS "Introduction Meeting Date",
                             CLI_INTRO_MEETING_COMM AS "Introduction Meeting Comments",
                             TO_CHAR(CLI_INTRO_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Intro_Next Follow-up Date",
                             TO_CHAR(FOLL_UP_MEETING_DATE,'DD-Mon-YYYY') AS "Follow-up Meeting Date",
                             PROD_INFO_PRODUCT_ID AS "Product For Discussion",
                             FOLL_UP_MEETING_COMMTS AS "Follow-up Meeting Comments",
                             TO_CHAR(FOLL_UP_NXT_FOLLUP_DATE,'DD-Mon-YYYY') AS "Follow-up Next Follow-up Date",
                             GR.QUOT_LEAD_CATG AS "Quote_Lead Category",
                             GR.QUOT_NO_OF_INSRD_EMP  AS "Quote_No. of Insured Employee",
                             GR.QUOT_NO_OF_INSRD_MEM AS "Quote_No. of Insured Members",
                             GR.QUOT_ETLIFE_PREM_RATE AS "Quote_ETlife Premium Rate",
                             GR.QUOT_ETLIFE_PREM_AMT  AS "Quote_Etlife Premium Amount",
                             GR.QUOT_FUND_CONTRI_AMT AS "Quote_Fund Contribution",
                             GR.QUOT_FUND_POTEN_ETLIFE_AMT AS "Quote_Fund Potential",
                             GR.QUOT_SUBMIT_EST_LIAB_FUND_IND AS "Quote Sub/Est Of Fund Lia",
                             QUOT_RIDERS AS "Quote_Riders",
                             QUOT_OPTIONS AS "Quote_Options",
                             TO_CHAR(GR.QUOT_SUBEST_LIAB_FUND_DATE,'DD-Mon-YYYY') AS "Quote_Issue Date/Est of Funds",
                             GR.QUOT_MEETING_COMMTS AS "Quote Meeting Comments",
                             TO_CHAR(GR.QUOT_TENT_CLOSURE_DATE,'DD-Mon-YYYY') AS "Quote_Tentative Closure Date",
                             TO_CHAR(GR.QUOT_FOLL_UP_DATE,'DD-Mon-YYYY')  AS "Quote Follow-up Date",
                             TO_CHAR(RESLT_CONF_DATE,'DD-Mon-YYYY') AS "Result_Confirmation Date",
                             RESLT_RESULT AS "Result_Status",
                             RESLT_REASON AS "Result_Reason",
                             RESLT_DESC_OTHER AS "Result_Other Reason Desc",
                             RESLT_POLICY_NO AS "Policy_No",
                             TO_CHAR(RESLT_DOC_DOR_DATE,'DD-Mon-YYYY') AS "Result_DOC/DOR",
                             RESLT_ACQR_PRVDDR_FUND_AMT AS "Result_Acq Serv Pro/Fund Amt",
                             RESLT_RENEWED_WITH AS "Result_Renewed With",
                             RESLT_CLOSURE_RATE AS "Result_Closure Rate",
                             RESLT_CLOSURE_PREM_AMT AS "Result_Closure Premium",
                             RESLT_CLOSURE_FCL AS "Result_FCL",
                             RESLT_RIDER_INFO AS "Result_Rider Related Info",
                             RESLT_UW_LIMITS AS "Result_UW Limits",
                             RESLT_PROFIT_SHARING_IND AS "Result_Profit Sharing",
                             RESLT_COMMENTS AS "Result Comments",
                             RESLT_FOLLOW_INS AS "Result_Follow-up",
                             TO_CHAR(RESLT_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Result_Follow-up Date",
                             CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_RATE,0) <> 0 
                             THEN  TO_CHAR((((GR.QUOT_ETLIFE_PREM_RATE- NVL(RESLT_CLOSURE_RATE,0))*100)/ GR.QUOT_ETLIFE_PREM_RATE),'fm99999.90') || '%'
                             ELSE '0' END  AS "Rate Difference",
                             NVL(TO_CHAR((GR.QUOT_ETLIFE_PREM_AMT- NVL(RESLT_CLOSURE_PREM_AMT,0)),'fm99999.90'),0) AS "Premium Gap",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_MEM)
                                       ELSE FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_EMP) END AS "Employee Band/Insured Person",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN 
                             FN_GET_GLMS_PRE_AMT_RANGE(CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_AMT,'-1') <> '-1'
                             THEN TO_CHAR(GR.QUOT_ETLIFE_PREM_AMT,'fm99999999999999999.90')
                             ELSE NVL(TO_CHAR(RESLT_CLOSURE_PREM_AMT,'fm99999999999999999.90'),'-1') END)
                             ELSE FN_GET_GLMS_PRE_AMT_RANGE(NVL(TO_CHAR(GR.QUOT_FUND_POTEN_ETLIFE_AMT,'fm99999999999999999.90'),'-1')) END  AS "Premium Amount Bucketing"
                         FROM GLMS_REPORTS_DETAILS GR 
                             LEFT JOIN ING_EDIT ST ON(GR.CLI_STATE = ST.ID)
                             INNER JOIN GLMS_MASTER_TABLE MT ON(GR.PROD_INFO_PRODUCT_ID = MT.MASTER_VALU_ID AND UPPER(MASTER_TYP_ID) = 'PRODUCT')
                             WHERE RESLT_DOC_DOR_DATE is not null
                             ORDER BY CLI_CLIENT_CODE;                             
                             
    ELSE
     OPEN IO_CURSOR FOR 
                     SELECT  CLI_CLIENT_CODE AS "Client Code",
                             CLI_CLIENT_NAME AS "Client Name",
                             CLI_GRP_COMPANY_NAME AS "Name of Group Company",
                             CLI_ADDRESS AS "Company Address",
                             CLI_CITY AS "City",
                             ST.PARAM_VALUE AS "State",
                             CLI_PINCODE AS "Pincode",
                             CLI_ESTB_YEAR AS "Establishment Year",
                             CLI_COMPANY_WEBSITE AS "Company Website",
                             CLI_INDUSTRY_TYPE AS "Industry Type",
                             CLI_GROUP_SIZE AS "Group Size",
                             MT.MASTER_DESC AS "Product Name",
                             PROD_INFO_CASE_TYPE AS "Type of Case",
                             TO_CHAR(PROD_INFO_COMCMT_REN_DATE,'DD-Mon-YYYY') AS "Date of Commencement/Renewal",
                             PROD_INFO_BENEFIT_STRUCT AS "Benefit Structure",
                             PROD_INFO_DESC_OTHER AS "Other Description",
                             PROD_INFO_IS_RIDER AS "Rider",
                             PROD_INFO_RIDERS AS "Name of Riders",
                             PROD_INFO_IS_OPTIONS AS "Options",
                             PROD_INFO_OPTIONS AS "Options Name",
                             PROD_INFO_EXIST_PREM_EXCL_TAX AS "Last Year Premium",
                             PROD_INFO_EXIST_INSR_LI AS "Current Insurer for LI",
                             PROD_INFO_EXIST_TRUST_IND AS "Existing Trust",
                             PROD_INFO_MANAGE_TYPE AS "Management Type",
                             PROD_INFO_TOTAL_FUND_VAL AS "Total Fund Valuation",
                             PROD_INFO_CURR_FUND_VALUE AS "Curr Insurer/Portfolio Amount",
                             REP_STATUS AS "Status",
                             CLI_INTRO_RM_NAME AS "Intro_RM Name",
                             CLI_INTRO_ESPOC AS "Intro_ET Life SPOC/Channel",
                             CLI_INTRO_RELATIONSHIP AS "Intro_Relationship",
                             CLI_INTRO_BUSSINESS_SOURCE AS "Intro_Business Source",
                             CLI_INTRO_CSPOC AS "Intro_Client Side SPOC",
                             CLI_INTRO_BSPOC AS "Intro_Broker Side SPOC",
                             CLI_INTRO_RIDERS AS "Intro_Riders",
                             CLI_INTRO_OPTIONS AS "Intro_Options",
                             TO_CHAR(CLI_INTRO_MEETING_DATE,'DD-Mon-YYYY') AS "Introduction Meeting Date",
                             CLI_INTRO_MEETING_COMM AS "Introduction Meeting Comments",
                             TO_CHAR(CLI_INTRO_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Intro_Next Follow-up Date",
                             TO_CHAR(FOLL_UP_MEETING_DATE,'DD-Mon-YYYY') AS "Follow-up Meeting Date",
                             PROD_INFO_PRODUCT_ID AS "Product For Discussion",
                             FOLL_UP_MEETING_COMMTS AS "Follow-up Meeting Comments",
                             TO_CHAR(FOLL_UP_NXT_FOLLUP_DATE,'DD-Mon-YYYY') AS "Follow-up Next Follow-up Date",
                             GR.QUOT_LEAD_CATG AS "Quote_Lead Category",
                             GR.QUOT_NO_OF_INSRD_EMP  AS "Quote_No. of Insured Employee",
                             GR.QUOT_NO_OF_INSRD_MEM AS "Quote_No. of Insured Members",
                             GR.QUOT_ETLIFE_PREM_RATE AS "Quote_ETlife Premium Rate",
                             GR.QUOT_ETLIFE_PREM_AMT  AS "Quote_Etlife Premium Amount",
                             GR.QUOT_FUND_CONTRI_AMT AS "Quote_Fund Contribution",
                             GR.QUOT_FUND_POTEN_ETLIFE_AMT AS "Quote_Fund Potential",
                             GR.QUOT_SUBMIT_EST_LIAB_FUND_IND AS "Quote Sub/Est Of Fund Lia",
                             QUOT_RIDERS AS "Quote_Riders",
                             QUOT_OPTIONS AS "Quote_Options",
                             TO_CHAR(GR.QUOT_SUBEST_LIAB_FUND_DATE,'DD-Mon-YYYY') AS "Quote_Issue Date/Est of Funds",
                             GR.QUOT_MEETING_COMMTS AS "Quote Meeting Comments",
                             TO_CHAR(GR.QUOT_TENT_CLOSURE_DATE,'DD-Mon-YYYY') AS "Quote_Tentative Closure Date",
                             TO_CHAR(GR.QUOT_FOLL_UP_DATE,'DD-Mon-YYYY')  AS "Quote Follow-up Date",
                             TO_CHAR(RESLT_CONF_DATE,'DD-Mon-YYYY') AS "Result_Confirmation Date",
                             RESLT_RESULT AS "Result_Status",
                             RESLT_REASON AS "Result_Reason",
                             RESLT_DESC_OTHER AS "Result_Other Reason Desc",
                             RESLT_POLICY_NO AS "Policy_No",
                             TO_CHAR(RESLT_DOC_DOR_DATE,'DD-Mon-YYYY') AS "Result_DOC/DOR",
                             RESLT_ACQR_PRVDDR_FUND_AMT AS "Result_Acq Serv Pro/Fund Amt",
                             RESLT_RENEWED_WITH AS "Result_Renewed With",
                             RESLT_CLOSURE_RATE AS "Result_Closure Rate",
                             RESLT_CLOSURE_PREM_AMT AS "Result_Closure Premium",
                             RESLT_CLOSURE_FCL AS "Result_FCL",
                             RESLT_RIDER_INFO AS "Result_Rider Related Info",
                             RESLT_UW_LIMITS AS "Result_UW Limits",
                             RESLT_PROFIT_SHARING_IND AS "Result_Profit Sharing",
                             RESLT_COMMENTS AS "Result Comments",
                             RESLT_FOLLOW_INS AS "Result_Follow-up",
                             TO_CHAR(RESLT_FOLLOW_UP_DATE,'DD-Mon-YYYY') AS "Result_Follow-up Date",
                             CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_RATE,0) <> 0 
                             THEN  TO_CHAR((((GR.QUOT_ETLIFE_PREM_RATE- NVL(RESLT_CLOSURE_RATE,0))*100)/ GR.QUOT_ETLIFE_PREM_RATE),'fm99999.90') || '%'
                             ELSE '0' END  AS "Rate Difference",
                             NVL(TO_CHAR((GR.QUOT_ETLIFE_PREM_AMT- NVL(RESLT_CLOSURE_PREM_AMT,0)),'fm99999.90'),0) AS "Premium Gap",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_MEM)
                                       ELSE FN_GET_GLMS_EMP_BAND(GR.QUOT_NO_OF_INSRD_EMP) END AS "Employee Band/Insured Person",
                             CASE WHEN CLI_INTRO_PROD_ID IN ('GTL_EMP','GTL_AFF','GTL_EDLI','GCP') THEN 
                             FN_GET_GLMS_PRE_AMT_RANGE(CASE WHEN NVL(GR.QUOT_ETLIFE_PREM_AMT,'-1') <> '-1'
                             THEN TO_CHAR(GR.QUOT_ETLIFE_PREM_AMT,'fm99999999999999999.90')
                             ELSE NVL(TO_CHAR(RESLT_CLOSURE_PREM_AMT,'fm99999999999999999.90'),'-1') END)
                             ELSE FN_GET_GLMS_PRE_AMT_RANGE(NVL(TO_CHAR(GR.QUOT_FUND_POTEN_ETLIFE_AMT,'fm99999999999999999.90'),'-1')) END  AS "Premium Amount Bucketing"
                         FROM GLMS_REPORTS_DETAILS GR 
                             LEFT JOIN ING_EDIT ST ON(GR.CLI_STATE = ST.ID)
                             INNER JOIN GLMS_MASTER_TABLE MT ON(GR.PROD_INFO_PRODUCT_ID = MT.MASTER_VALU_ID AND UPPER(MASTER_TYP_ID) = 'PRODUCT')
                             --WHERE CLI_CREATED_DATE is not null
                             ORDER BY CLI_CLIENT_CODE;
    END IF;                         
  DELETE FROM GLMS_REPORTS_DETAILS;
  COMMIT;     
END USP_GET_GLMS_ADV_REPORTS;
